{"resolvedId":"/home/edge/dev/js/private-cloud/src/components/Directory/Files/RFile.tsx","transforms":[{"name":"__load__","result":"import { FiCheckSquare, FiDownload, FiTrash2 } from 'solid-icons/fi';\nimport { createEffect, createSignal } from 'solid-js';\nimport { useLocation } from 'solid-start';\n\nimport { useExplorerCtx } from '~/context/ExplorerCtx';\nimport { FileOrFolder } from '~/types';\nimport FileIcon from '~/components/FileIcon';\nimport FileBtn from './FileBtn';\n\ninterface IFile {\n    file: FileOrFolder;\n    i: number;\n}\n\nexport default function RFile( { file, i }: IFile )\n{\n    const { name, selected } = file;\n\n    const [fallback, setFallback] = createSignal<boolean>(false)\n    const [loaded, setLoaded] = createSignal<boolean>(false)\n    const [hover, setHover] = createSignal<boolean>(false);\n    const [src, setSrc] = createSignal<string>('')\n\n    const onMouseOver = () => setHover(true);\n    const onMouseOut = () => setHover(false)\n    \n    const { isSelecting, toggleSelectExplorer, downloadOneFile, removeOneFile } = useExplorerCtx();\n    const { pathname } = useLocation();\n\n    // TODO: improve -> use a react image library\n    // TODO: then -> make animate-fade-in work\n    createEffect( () => {\n        setFallback(false)\n        // FIXME: dynamic url\n        const to = pathname + name;\n        const src = `http://localhost:3001${to}`\n        setSrc(src)\n        setLoaded(false)\n    }, [name] )\n\n    const onError = () => {\n        setFallback(true);\n        setLoaded(true);\n    }\n    const onLoad = () => setLoaded(true)\n\n    const extension = pathname.split('.').pop() || ''; \n    \n    const onClick = () => isSelecting() \n        ? toggleSelectExplorer(i)()\n        : null // TODO: show image big\n\n    const onDownloadClick = (e: MouseEvent) => {\n        e.preventDefault()\n        e.stopPropagation()\n        downloadOneFile(name)\n    }\n\n    const onDeleteClick = (e: MouseEvent) => {\n        e.preventDefault()\n        e.stopPropagation()\n        removeOneFile(name)\n    }\n\n    return (\n        <div \n            class=\"repo-elt repo-elt-file truncate relative transition-opacity duration-500\" \n            style={ { opacity: loaded() ? 1 : 0 } }\n            onClick={onClick} \n            onMouseOver={onMouseOver} \n            onMouseOut={onMouseOut}\n        >\n            { fallback()\n                ? \n                    <>\n                        <FileIcon extension={extension} size={4} />\n                        <p class=\"text-xs text-center truncate\" style={{width: '100px'}}>{name}</p>\n                    </>\n                : <img \n                    loading='lazy'\n                    src={src()}  \n                    onError={onError} \n                    onLoad={onLoad} />\n            }\n            <FileBtn\n                className='inset-1 w-min h-min bg-green-50'\n                iconClassName='text-green-500' \n                Icon={FiCheckSquare}  \n                display={isSelecting() && selected} />\n            <FileBtn \n                className='bottom-1 right-1 bg-blue-100 [&:hover>*]:text-blue-600' \n                Icon={FiDownload} \n                iconClassName='text-blue-500 scale-90' \n                display={!isSelecting && hover} \n                onClick={onDownloadClick} />\n            <FileBtn \n                className='top-1 right-1 bg-red-100 [&:hover>*]:text-red-600' \n                Icon={FiTrash2} \n                iconClassName='text-red-500' \n                display={!isSelecting && hover} \n                onClick={onDeleteClick} />\n        </div>\n    )\n}","start":1675682511851,"end":1675682511851},{"name":"solid","result":"import { ssrAttribute as _$ssrAttribute } from \"solid-js/web\";\nimport { ssr as _$ssr } from \"solid-js/web\";\nimport { createComponent as _$createComponent } from \"solid-js/web\";\nimport { escape as _$escape } from \"solid-js/web\";\nimport { ssrHydrationKey as _$ssrHydrationKey } from \"solid-js/web\";\nconst _tmpl$ = [\"<div\", \" class=\\\"repo-elt repo-elt-file truncate relative transition-opacity duration-500\\\" style=\\\"\", \"\\\"><!--#-->\", \"<!--/--><!--#-->\", \"<!--/--><!--#-->\", \"<!--/--><!--#-->\", \"<!--/--></div>\"],\n  _tmpl$2 = [\"<p\", \" class=\\\"text-xs text-center truncate\\\" style=\\\"\", \"\\\">\", \"</p>\"],\n  _tmpl$3 = [\"<img\", \" loading=\\\"lazy\\\"\", \">\"];\nimport { FiCheckSquare, FiDownload, FiTrash2 } from 'solid-icons/fi';\nimport { createEffect, createSignal } from 'solid-js';\nimport { useLocation } from 'solid-start';\nimport { useExplorerCtx } from '~/context/ExplorerCtx';\nimport FileIcon from '~/components/FileIcon';\nimport FileBtn from './FileBtn';\nexport default function RFile({\n  file,\n  i\n}) {\n  const {\n    name,\n    selected\n  } = file;\n  const [fallback, setFallback] = createSignal(false);\n  const [loaded, setLoaded] = createSignal(false);\n  const [hover, setHover] = createSignal(false);\n  const [src, setSrc] = createSignal('');\n  const onMouseOver = () => setHover(true);\n  const onMouseOut = () => setHover(false);\n  const {\n    isSelecting,\n    toggleSelectExplorer,\n    downloadOneFile,\n    removeOneFile\n  } = useExplorerCtx();\n  const {\n    pathname\n  } = useLocation();\n\n  // TODO: improve -> use a react image library\n  // TODO: then -> make animate-fade-in work\n  createEffect(() => {\n    setFallback(false);\n    // FIXME: dynamic url\n    const to = pathname + name;\n    const src = `http://localhost:3001${to}`;\n    setSrc(src);\n    setLoaded(false);\n  }, [name]);\n  const onError = () => {\n    setFallback(true);\n    setLoaded(true);\n  };\n  const onLoad = () => setLoaded(true);\n  const extension = pathname.split('.').pop() || '';\n  const onClick = () => isSelecting() ? toggleSelectExplorer(i)() : null; // TODO: show image big\n\n  const onDownloadClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    downloadOneFile(name);\n  };\n  const onDeleteClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    removeOneFile(name);\n  };\n  return _$ssr(_tmpl$, _$ssrHydrationKey(), \"opacity:\" + (loaded() ? 1 : 0), fallback() ? _$escape([_$createComponent(FileIcon, {\n    extension: extension,\n    size: 4\n  }), _$ssr(_tmpl$2, _$ssrHydrationKey(), \"width:\" + \"100px\", _$escape(name))]) : _$ssr(_tmpl$3, _$ssrHydrationKey(), _$ssrAttribute(\"src\", _$escape(src(), true), false)), _$escape(_$createComponent(FileBtn, {\n    className: 'inset-1 w-min h-min bg-green-50',\n    iconClassName: 'text-green-500',\n    Icon: FiCheckSquare,\n    get display() {\n      return isSelecting() && selected;\n    }\n  })), _$escape(_$createComponent(FileBtn, {\n    className: 'bottom-1 right-1 bg-blue-100 [&:hover>*]:text-blue-600',\n    Icon: FiDownload,\n    iconClassName: 'text-blue-500 scale-90',\n    display: !isSelecting && hover,\n    onClick: onDownloadClick\n  })), _$escape(_$createComponent(FileBtn, {\n    className: 'top-1 right-1 bg-red-100 [&:hover>*]:text-red-600',\n    Icon: FiTrash2,\n    iconClassName: 'text-red-500',\n    display: !isSelecting && hover,\n    onClick: onDeleteClick\n  })));\n}","start":1675682511851,"end":1675682511878,"order":"pre"},{"name":"vite:define","result":"import { ssrAttribute as _$ssrAttribute } from \"solid-js/web\";\nimport { ssr as _$ssr } from \"solid-js/web\";\nimport { createComponent as _$createComponent } from \"solid-js/web\";\nimport { escape as _$escape } from \"solid-js/web\";\nimport { ssrHydrationKey as _$ssrHydrationKey } from \"solid-js/web\";\nconst _tmpl$ = [\"<div\", \" class=\\\"repo-elt repo-elt-file truncate relative transition-opacity duration-500\\\" style=\\\"\", \"\\\"><!--#-->\", \"<!--/--><!--#-->\", \"<!--/--><!--#-->\", \"<!--/--><!--#-->\", \"<!--/--></div>\"],\n  _tmpl$2 = [\"<p\", \" class=\\\"text-xs text-center truncate\\\" style=\\\"\", \"\\\">\", \"</p>\"],\n  _tmpl$3 = [\"<img\", \" loading=\\\"lazy\\\"\", \">\"];\nimport { FiCheckSquare, FiDownload, FiTrash2 } from 'solid-icons/fi';\nimport { createEffect, createSignal } from 'solid-js';\nimport { useLocation } from 'solid-start';\nimport { useExplorerCtx } from '~/context/ExplorerCtx';\nimport FileIcon from '~/components/FileIcon';\nimport FileBtn from './FileBtn';\nexport default function RFile({\n  file,\n  i\n}) {\n  const {\n    name,\n    selected\n  } = file;\n  const [fallback, setFallback] = createSignal(false);\n  const [loaded, setLoaded] = createSignal(false);\n  const [hover, setHover] = createSignal(false);\n  const [src, setSrc] = createSignal('');\n  const onMouseOver = () => setHover(true);\n  const onMouseOut = () => setHover(false);\n  const {\n    isSelecting,\n    toggleSelectExplorer,\n    downloadOneFile,\n    removeOneFile\n  } = useExplorerCtx();\n  const {\n    pathname\n  } = useLocation();\n\n  // TODO: improve -> use a react image library\n  // TODO: then -> make animate-fade-in work\n  createEffect(() => {\n    setFallback(false);\n    // FIXME: dynamic url\n    const to = pathname + name;\n    const src = `http://localhost:3001${to}`;\n    setSrc(src);\n    setLoaded(false);\n  }, [name]);\n  const onError = () => {\n    setFallback(true);\n    setLoaded(true);\n  };\n  const onLoad = () => setLoaded(true);\n  const extension = pathname.split('.').pop() || '';\n  const onClick = () => isSelecting() ? toggleSelectExplorer(i)() : null; // TODO: show image big\n\n  const onDownloadClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    downloadOneFile(name);\n  };\n  const onDeleteClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    removeOneFile(name);\n  };\n  return _$ssr(_tmpl$, _$ssrHydrationKey(), \"opacity:\" + (loaded() ? 1 : 0), fallback() ? _$escape([_$createComponent(FileIcon, {\n    extension: extension,\n    size: 4\n  }), _$ssr(_tmpl$2, _$ssrHydrationKey(), \"width:\" + \"100px\", _$escape(name))]) : _$ssr(_tmpl$3, _$ssrHydrationKey(), _$ssrAttribute(\"src\", _$escape(src(), true), false)), _$escape(_$createComponent(FileBtn, {\n    className: 'inset-1 w-min h-min bg-green-50',\n    iconClassName: 'text-green-500',\n    Icon: FiCheckSquare,\n    get display() {\n      return isSelecting() && selected;\n    }\n  })), _$escape(_$createComponent(FileBtn, {\n    className: 'bottom-1 right-1 bg-blue-100 [&:hover>*]:text-blue-600',\n    Icon: FiDownload,\n    iconClassName: 'text-blue-500 scale-90',\n    display: !isSelecting && hover,\n    onClick: onDownloadClick\n  })), _$escape(_$createComponent(FileBtn, {\n    className: 'top-1 right-1 bg-red-100 [&:hover>*]:text-red-600',\n    Icon: FiTrash2,\n    iconClassName: 'text-red-500',\n    display: !isSelecting && hover,\n    onClick: onDeleteClick\n  })));\n}","start":1675682511878,"end":1675682511878,"order":"normal"},{"name":"vite:import-analysis","result":"import { ssrAttribute as _$ssrAttribute } from \"solid-js/web\";\nimport { ssr as _$ssr } from \"solid-js/web\";\nimport { createComponent as _$createComponent } from \"solid-js/web\";\nimport { escape as _$escape } from \"solid-js/web\";\nimport { ssrHydrationKey as _$ssrHydrationKey } from \"solid-js/web\";\nconst _tmpl$ = [\"<div\", \" class=\\\"repo-elt repo-elt-file truncate relative transition-opacity duration-500\\\" style=\\\"\", \"\\\"><!--#-->\", \"<!--/--><!--#-->\", \"<!--/--><!--#-->\", \"<!--/--><!--#-->\", \"<!--/--></div>\"],\n  _tmpl$2 = [\"<p\", \" class=\\\"text-xs text-center truncate\\\" style=\\\"\", \"\\\">\", \"</p>\"],\n  _tmpl$3 = [\"<img\", \" loading=\\\"lazy\\\"\", \">\"];\nimport { FiCheckSquare, FiDownload, FiTrash2 } from 'solid-icons/fi';\nimport { createEffect, createSignal } from 'solid-js';\nimport { useLocation } from '/node_modules/solid-start/index.tsx';\nimport { useExplorerCtx } from '/src/context/ExplorerCtx.tsx';\nimport FileIcon from '/src/components/FileIcon.tsx';\nimport FileBtn from '/src/components/Directory/Files/FileBtn.tsx';\nexport default function RFile({\n  file,\n  i\n}) {\n  const {\n    name,\n    selected\n  } = file;\n  const [fallback, setFallback] = createSignal(false);\n  const [loaded, setLoaded] = createSignal(false);\n  const [hover, setHover] = createSignal(false);\n  const [src, setSrc] = createSignal('');\n  const onMouseOver = () => setHover(true);\n  const onMouseOut = () => setHover(false);\n  const {\n    isSelecting,\n    toggleSelectExplorer,\n    downloadOneFile,\n    removeOneFile\n  } = useExplorerCtx();\n  const {\n    pathname\n  } = useLocation();\n\n  // TODO: improve -> use a react image library\n  // TODO: then -> make animate-fade-in work\n  createEffect(() => {\n    setFallback(false);\n    // FIXME: dynamic url\n    const to = pathname + name;\n    const src = `http://localhost:3001${to}`;\n    setSrc(src);\n    setLoaded(false);\n  }, [name]);\n  const onError = () => {\n    setFallback(true);\n    setLoaded(true);\n  };\n  const onLoad = () => setLoaded(true);\n  const extension = pathname.split('.').pop() || '';\n  const onClick = () => isSelecting() ? toggleSelectExplorer(i)() : null; // TODO: show image big\n\n  const onDownloadClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    downloadOneFile(name);\n  };\n  const onDeleteClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    removeOneFile(name);\n  };\n  return _$ssr(_tmpl$, _$ssrHydrationKey(), \"opacity:\" + (loaded() ? 1 : 0), fallback() ? _$escape([_$createComponent(FileIcon, {\n    extension: extension,\n    size: 4\n  }), _$ssr(_tmpl$2, _$ssrHydrationKey(), \"width:\" + \"100px\", _$escape(name))]) : _$ssr(_tmpl$3, _$ssrHydrationKey(), _$ssrAttribute(\"src\", _$escape(src(), true), false)), _$escape(_$createComponent(FileBtn, {\n    className: 'inset-1 w-min h-min bg-green-50',\n    iconClassName: 'text-green-500',\n    Icon: FiCheckSquare,\n    get display() {\n      return isSelecting() && selected;\n    }\n  })), _$escape(_$createComponent(FileBtn, {\n    className: 'bottom-1 right-1 bg-blue-100 [&:hover>*]:text-blue-600',\n    Icon: FiDownload,\n    iconClassName: 'text-blue-500 scale-90',\n    display: !isSelecting && hover,\n    onClick: onDownloadClick\n  })), _$escape(_$createComponent(FileBtn, {\n    className: 'top-1 right-1 bg-red-100 [&:hover>*]:text-red-600',\n    Icon: FiTrash2,\n    iconClassName: 'text-red-500',\n    display: !isSelecting && hover,\n    onClick: onDeleteClick\n  })));\n}","start":1675682511879,"end":1675682511881,"order":"normal"}]}
