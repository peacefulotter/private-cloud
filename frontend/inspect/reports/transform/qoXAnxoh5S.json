{"resolvedId":"/home/edge/dev/js/private-cloud/src/components/Directory/Files/RFile.tsx","transforms":[{"name":"__load__","result":"import { FiCheckSquare, FiDownload, FiTrash2 } from 'solid-icons/fi';\nimport { createEffect, createSignal } from 'solid-js';\nimport { useLocation } from 'solid-start';\n\nimport { useExplorerCtx } from '~/context/ExplorerCtx';\nimport { FileOrFolder } from '~/types';\nimport FileIcon from '~/components/FileIcon';\nimport FileBtn from './FileBtn';\n\ninterface IFile {\n    file: FileOrFolder;\n    i: number;\n}\n\nexport default function RFile( { file, i }: IFile )\n{\n    const { name, selected } = file;\n\n    const [fallback, setFallback] = createSignal<boolean>(false)\n    const [loaded, setLoaded] = createSignal<boolean>(false)\n    const [hover, setHover] = createSignal<boolean>(false);\n    const [src, setSrc] = createSignal<string>('')\n\n    const onMouseOver = () => setHover(true);\n    const onMouseOut = () => setHover(false)\n    \n    const { isSelecting, toggleSelectExplorer, downloadOneFile, removeOneFile } = useExplorerCtx();\n    const { pathname } = useLocation();\n\n    // TODO: improve -> use a react image library\n    // TODO: then -> make animate-fade-in work\n    createEffect( () => {\n        setFallback(false)\n        // FIXME: dynamic url\n        const to = pathname + name;\n        const src = `http://localhost:3001${to}`\n        setSrc(src)\n        setLoaded(false)\n    }, [name] )\n\n    const onError = () => {\n        setFallback(true);\n        setLoaded(true);\n    }\n    const onLoad = () => setLoaded(true)\n\n    const extension = pathname.split('.').pop() || ''; \n    \n    const onClick = () => isSelecting() \n        ? toggleSelectExplorer(i)()\n        : null // TODO: show image big\n\n    const onDownloadClick = (e: MouseEvent) => {\n        e.preventDefault()\n        e.stopPropagation()\n        downloadOneFile(name)\n    }\n\n    const onDeleteClick = (e: MouseEvent) => {\n        e.preventDefault()\n        e.stopPropagation()\n        removeOneFile(name)\n    }\n\n    return (\n        <div \n            class=\"repo-elt repo-elt-file truncate relative transition-opacity duration-500\" \n            style={ { opacity: loaded() ? 1 : 0 } }\n            onClick={onClick} \n            onMouseOver={onMouseOver} \n            onMouseOut={onMouseOut}\n        >\n            { fallback()\n                ? \n                    <>\n                        <FileIcon extension={extension} size={4} />\n                        <p class=\"text-xs text-center truncate\" style={{width: '100px'}}>{name}</p>\n                    </>\n                : <img \n                    loading='lazy'\n                    src={src()}  \n                    onError={onError} \n                    onLoad={onLoad} />\n            }\n            <FileBtn\n                className='inset-1 w-min h-min bg-green-50'\n                iconClassName='text-green-500' \n                Icon={FiCheckSquare}  \n                display={isSelecting() && selected} />\n            <FileBtn \n                className='bottom-1 right-1 bg-blue-100 [&:hover>*]:text-blue-600' \n                Icon={FiDownload} \n                iconClassName='text-blue-500 scale-90' \n                display={!isSelecting && hover} \n                onClick={onDownloadClick} />\n            <FileBtn \n                className='top-1 right-1 bg-red-100 [&:hover>*]:text-red-600' \n                Icon={FiTrash2} \n                iconClassName='text-red-500' \n                display={!isSelecting && hover} \n                onClick={onDeleteClick} />\n        </div>\n    )\n}","start":1675682384492,"end":1675682384492},{"name":"solid","result":"import { template as _$template } from \"solid-js/web\";\nimport { delegateEvents as _$delegateEvents } from \"solid-js/web\";\nimport { setAttribute as _$setAttribute } from \"solid-js/web\";\nimport { effect as _$effect } from \"solid-js/web\";\nimport { getNextElement as _$getNextElement } from \"solid-js/web\";\nimport { runHydrationEvents as _$runHydrationEvents } from \"solid-js/web\";\nimport { getNextMarker as _$getNextMarker } from \"solid-js/web\";\nimport { insert as _$insert } from \"solid-js/web\";\nimport { createComponent as _$createComponent } from \"solid-js/web\";\nimport { memo as _$memo } from \"solid-js/web\";\nimport { esm as _esm } from \"solid-refresh\";\nimport { shouldWarnAndDecline as _shouldWarnAndDecline } from \"solid-refresh\";\nconst _tmpl$ = /*#__PURE__*/_$template(`<div class=\"repo-elt repo-elt-file truncate relative transition-opacity duration-500\"><!#><!/><!#><!/><!#><!/><!#><!/></div>`, 10),\n  _tmpl$2 = /*#__PURE__*/_$template(`<p class=\"text-xs text-center truncate\"></p>`, 2),\n  _tmpl$3 = /*#__PURE__*/_$template(`<img loading=\"lazy\">`, 1);\nimport { FiCheckSquare, FiDownload, FiTrash2 } from 'solid-icons/fi';\nimport { createEffect, createSignal } from 'solid-js';\nimport { useLocation } from 'solid-start';\nimport { useExplorerCtx } from '~/context/ExplorerCtx';\nimport FileIcon from '~/components/FileIcon';\nimport FileBtn from './FileBtn';\nexport const $$registrations = {};\nconst _Hot$$RFile = function RFile({\n  file,\n  i\n}) {\n  const {\n    name,\n    selected\n  } = file;\n  const [fallback, setFallback] = createSignal(false);\n  const [loaded, setLoaded] = createSignal(false);\n  const [hover, setHover] = createSignal(false);\n  const [src, setSrc] = createSignal('');\n  const onMouseOver = () => setHover(true);\n  const onMouseOut = () => setHover(false);\n  const {\n    isSelecting,\n    toggleSelectExplorer,\n    downloadOneFile,\n    removeOneFile\n  } = useExplorerCtx();\n  const {\n    pathname\n  } = useLocation();\n\n  // TODO: improve -> use a react image library\n  // TODO: then -> make animate-fade-in work\n  createEffect(() => {\n    setFallback(false);\n    // FIXME: dynamic url\n    const to = pathname + name;\n    const src = `http://localhost:3001${to}`;\n    setSrc(src);\n    setLoaded(false);\n  }, [name]);\n  const onError = () => {\n    setFallback(true);\n    setLoaded(true);\n  };\n  const onLoad = () => setLoaded(true);\n  const extension = pathname.split('.').pop() || '';\n  const onClick = () => isSelecting() ? toggleSelectExplorer(i)() : null; // TODO: show image big\n\n  const onDownloadClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    downloadOneFile(name);\n  };\n  const onDeleteClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    removeOneFile(name);\n  };\n  return (() => {\n    const _el$ = _$getNextElement(_tmpl$),\n      _el$2 = _el$.firstChild,\n      [_el$3, _co$] = _$getNextMarker(_el$2.nextSibling),\n      _el$4 = _el$3.nextSibling,\n      [_el$5, _co$2] = _$getNextMarker(_el$4.nextSibling),\n      _el$6 = _el$5.nextSibling,\n      [_el$7, _co$3] = _$getNextMarker(_el$6.nextSibling),\n      _el$8 = _el$7.nextSibling,\n      [_el$9, _co$4] = _$getNextMarker(_el$8.nextSibling);\n    _el$.$$mouseout = onMouseOut;\n    _el$.$$mouseover = onMouseOver;\n    _el$.$$click = onClick;\n    _$insert(_el$, (() => {\n      const _c$ = _$memo(() => !!fallback());\n      return () => _c$() ? [_$createComponent(FileIcon, {\n        extension: extension,\n        size: 4\n      }), (() => {\n        const _el$10 = _$getNextElement(_tmpl$2);\n        _el$10.style.setProperty(\"width\", \"100px\");\n        _$insert(_el$10, name);\n        return _el$10;\n      })()] : (() => {\n        const _el$11 = _$getNextElement(_tmpl$3);\n        _el$11.addEventListener(\"load\", onLoad);\n        _el$11.addEventListener(\"error\", onError);\n        _$effect(() => _$setAttribute(_el$11, \"src\", src()));\n        return _el$11;\n      })();\n    })(), _el$3, _co$);\n    _$insert(_el$, _$createComponent(FileBtn, {\n      className: 'inset-1 w-min h-min bg-green-50',\n      iconClassName: 'text-green-500',\n      Icon: FiCheckSquare,\n      get display() {\n        return isSelecting() && selected;\n      }\n    }), _el$5, _co$2);\n    _$insert(_el$, _$createComponent(FileBtn, {\n      className: 'bottom-1 right-1 bg-blue-100 [&:hover>*]:text-blue-600',\n      Icon: FiDownload,\n      iconClassName: 'text-blue-500 scale-90',\n      display: !isSelecting && hover,\n      onClick: onDownloadClick\n    }), _el$7, _co$3);\n    _$insert(_el$, _$createComponent(FileBtn, {\n      className: 'top-1 right-1 bg-red-100 [&:hover>*]:text-red-600',\n      Icon: FiTrash2,\n      iconClassName: 'text-red-500',\n      display: !isSelecting && hover,\n      onClick: onDeleteClick\n    }), _el$9, _co$4);\n    _$effect(() => _el$.style.setProperty(\"opacity\", loaded() ? 1 : 0));\n    _$runHydrationEvents();\n    return _el$;\n  })();\n};\n$$registrations._Hot$$RFile = {\n  component: _Hot$$RFile,\n  id: \"_Hot$$RFile\"\n};\nconst {\n  handler: _handler,\n  Component: _Component\n} = _esm($$registrations._Hot$$RFile, import.meta.hot);\nif (import.meta.hot) import.meta.hot.accept(_mod => {\n  _handler(_mod) && import.meta.hot.invalidate();\n});\nexport default _Component;\nif (_shouldWarnAndDecline()) if (import.meta.hot) import.meta.hot.decline();\n_$delegateEvents([\"click\", \"mouseover\", \"mouseout\"]);","start":1675682384492,"end":1675682384518,"order":"pre"},{"name":"vite:import-analysis","result":"import { createHotContext as __vite__createHotContext } from \"/@vite/client\";import.meta.hot = __vite__createHotContext(\"/src/components/Directory/Files/RFile.tsx\");import { template as _$template } from \"/node_modules/.vite/deps/solid-js_web.js?v=2963516b\";\nimport { delegateEvents as _$delegateEvents } from \"/node_modules/.vite/deps/solid-js_web.js?v=2963516b\";\nimport { setAttribute as _$setAttribute } from \"/node_modules/.vite/deps/solid-js_web.js?v=2963516b\";\nimport { effect as _$effect } from \"/node_modules/.vite/deps/solid-js_web.js?v=2963516b\";\nimport { getNextElement as _$getNextElement } from \"/node_modules/.vite/deps/solid-js_web.js?v=2963516b\";\nimport { runHydrationEvents as _$runHydrationEvents } from \"/node_modules/.vite/deps/solid-js_web.js?v=2963516b\";\nimport { getNextMarker as _$getNextMarker } from \"/node_modules/.vite/deps/solid-js_web.js?v=2963516b\";\nimport { insert as _$insert } from \"/node_modules/.vite/deps/solid-js_web.js?v=2963516b\";\nimport { createComponent as _$createComponent } from \"/node_modules/.vite/deps/solid-js_web.js?v=2963516b\";\nimport { memo as _$memo } from \"/node_modules/.vite/deps/solid-js_web.js?v=2963516b\";\nimport { esm as _esm } from \"/@solid-refresh\";\nimport { shouldWarnAndDecline as _shouldWarnAndDecline } from \"/@solid-refresh\";\nconst _tmpl$ = /*#__PURE__*/_$template(`<div class=\"repo-elt repo-elt-file truncate relative transition-opacity duration-500\"><!#><!/><!#><!/><!#><!/><!#><!/></div>`, 10),\n  _tmpl$2 = /*#__PURE__*/_$template(`<p class=\"text-xs text-center truncate\"></p>`, 2),\n  _tmpl$3 = /*#__PURE__*/_$template(`<img loading=\"lazy\">`, 1);\nimport { FiCheckSquare, FiDownload, FiTrash2 } from '/node_modules/.vite/deps/solid-icons_fi.js?v=2963516b';\nimport { createEffect, createSignal } from '/node_modules/.vite/deps/solid-js.js?v=2963516b';\nimport { useLocation } from '/node_modules/solid-start/index.tsx?v=2963516b';\nimport { useExplorerCtx } from '/src/context/ExplorerCtx.tsx?t=1675682384269';\nimport FileIcon from '/src/components/FileIcon.tsx';\nimport FileBtn from '/src/components/Directory/Files/FileBtn.tsx';\nexport const $$registrations = {};\nconst _Hot$$RFile = function RFile({\n  file,\n  i\n}) {\n  const {\n    name,\n    selected\n  } = file;\n  const [fallback, setFallback] = createSignal(false);\n  const [loaded, setLoaded] = createSignal(false);\n  const [hover, setHover] = createSignal(false);\n  const [src, setSrc] = createSignal('');\n  const onMouseOver = () => setHover(true);\n  const onMouseOut = () => setHover(false);\n  const {\n    isSelecting,\n    toggleSelectExplorer,\n    downloadOneFile,\n    removeOneFile\n  } = useExplorerCtx();\n  const {\n    pathname\n  } = useLocation();\n\n  // TODO: improve -> use a react image library\n  // TODO: then -> make animate-fade-in work\n  createEffect(() => {\n    setFallback(false);\n    // FIXME: dynamic url\n    const to = pathname + name;\n    const src = `http://localhost:3001${to}`;\n    setSrc(src);\n    setLoaded(false);\n  }, [name]);\n  const onError = () => {\n    setFallback(true);\n    setLoaded(true);\n  };\n  const onLoad = () => setLoaded(true);\n  const extension = pathname.split('.').pop() || '';\n  const onClick = () => isSelecting() ? toggleSelectExplorer(i)() : null; // TODO: show image big\n\n  const onDownloadClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    downloadOneFile(name);\n  };\n  const onDeleteClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    removeOneFile(name);\n  };\n  return (() => {\n    const _el$ = _$getNextElement(_tmpl$),\n      _el$2 = _el$.firstChild,\n      [_el$3, _co$] = _$getNextMarker(_el$2.nextSibling),\n      _el$4 = _el$3.nextSibling,\n      [_el$5, _co$2] = _$getNextMarker(_el$4.nextSibling),\n      _el$6 = _el$5.nextSibling,\n      [_el$7, _co$3] = _$getNextMarker(_el$6.nextSibling),\n      _el$8 = _el$7.nextSibling,\n      [_el$9, _co$4] = _$getNextMarker(_el$8.nextSibling);\n    _el$.$$mouseout = onMouseOut;\n    _el$.$$mouseover = onMouseOver;\n    _el$.$$click = onClick;\n    _$insert(_el$, (() => {\n      const _c$ = _$memo(() => !!fallback());\n      return () => _c$() ? [_$createComponent(FileIcon, {\n        extension: extension,\n        size: 4\n      }), (() => {\n        const _el$10 = _$getNextElement(_tmpl$2);\n        _el$10.style.setProperty(\"width\", \"100px\");\n        _$insert(_el$10, name);\n        return _el$10;\n      })()] : (() => {\n        const _el$11 = _$getNextElement(_tmpl$3);\n        _el$11.addEventListener(\"load\", onLoad);\n        _el$11.addEventListener(\"error\", onError);\n        _$effect(() => _$setAttribute(_el$11, \"src\", src()));\n        return _el$11;\n      })();\n    })(), _el$3, _co$);\n    _$insert(_el$, _$createComponent(FileBtn, {\n      className: 'inset-1 w-min h-min bg-green-50',\n      iconClassName: 'text-green-500',\n      Icon: FiCheckSquare,\n      get display() {\n        return isSelecting() && selected;\n      }\n    }), _el$5, _co$2);\n    _$insert(_el$, _$createComponent(FileBtn, {\n      className: 'bottom-1 right-1 bg-blue-100 [&:hover>*]:text-blue-600',\n      Icon: FiDownload,\n      iconClassName: 'text-blue-500 scale-90',\n      display: !isSelecting && hover,\n      onClick: onDownloadClick\n    }), _el$7, _co$3);\n    _$insert(_el$, _$createComponent(FileBtn, {\n      className: 'top-1 right-1 bg-red-100 [&:hover>*]:text-red-600',\n      Icon: FiTrash2,\n      iconClassName: 'text-red-500',\n      display: !isSelecting && hover,\n      onClick: onDeleteClick\n    }), _el$9, _co$4);\n    _$effect(() => _el$.style.setProperty(\"opacity\", loaded() ? 1 : 0));\n    _$runHydrationEvents();\n    return _el$;\n  })();\n};\n$$registrations._Hot$$RFile = {\n  component: _Hot$$RFile,\n  id: \"_Hot$$RFile\"\n};\nconst {\n  handler: _handler,\n  Component: _Component\n} = _esm($$registrations._Hot$$RFile, import.meta.hot);\nif (import.meta.hot) import.meta.hot.accept(_mod => {\n  _handler(_mod) && import.meta.hot.invalidate();\n});\nexport default _Component;\nif (_shouldWarnAndDecline()) if (import.meta.hot) import.meta.hot.decline();\n_$delegateEvents([\"click\", \"mouseover\", \"mouseout\"]);","start":1675682384518,"end":1675682384520,"order":"normal"}]}
